# nlcheck.py

アルゴリズムデザインコンテストの回答チェックツール(2016年版)です。

[2014年のときの情報](http://www.sig-sldm.org/nlcheck.html)

コマンドライン版ツールとしても、実行できます。実行方法は、ファイル内のコメントを参照してください。

2016年版では、過去の問題フォーマットとの互換性は保ちつつ、3D問題向けに拡張しています。

## チェックの内容

基本的には、「ペンシルパズル本156 ナンバーリンク4」(ニコリ) ISBN978-4-89072-256-3 に記載のルールに準拠しています。

- チェック1. 問題の数字の位置と、同じである。
- チェック2. 問題にはない数字があってはいけない。
- チェック3. 問題の数字の位置が、線の端点である。
- チェック4. 線は枝分かれしない。
- チェック5. 線はつながっている。※ 回答ファイルの書式の都合上、線が交差することはありえません。
- チェック6. 複数解があるときに、同一の解が含まれていたら、２つめ以降は不正解として扱う。※ コンテスト専用ルール。2015年版では考慮不要

さらに2016年版では、3D問題に対応したVIA関連のチェックを追加しています。


## 2016年版ルール

2015年版から **解の品質** が追加されています。

出力は、以下のような形式になります。

```
judges =  [[True, 0.0027247956403269754], [False, 0.0], [False, 0.0], [True, 0.0032679738562091504], [False, 0.0]]
```

1. Trueなら正解、Falseなら不正解
2. 解の品質の値

## 2015年版の隠し機能


### お掃除

とあるsolverが、無駄な線を空き地にしきつめた解（ナンバーリンクのルールでは不正解）を出力するので、「きれいに掃除する」機能をつくりました。

```
nlcheck.py --input 問題ファイル --target 回答ファイル --clean 掃除したあとの回答の出力先ファイル
```

### グラフィック出力

回答ファイルを、GIF形式のグラフィックデータとして出力します。

```
nlcheck.py --input 問題ファイル --target 回答ファイル --gif 出力先ファイル
```

実行には、python-gdが必要です。



<!--
### 問題データのチェック機能 (numberlink.py)

[これと](adc2015.md#curl-qcheck)同等の機能です。

```
python numberlink.py 問題ファイル
```
-->



## バグ修正の履歴

- 空き地（線の番号が0）の部分も、線だと誤認識して、ルールのチェックをしていました。そのため、正解なのに不正解だと誤判定する場合がありました。
  - ちなみに、2014年のコンテストでは不正解はありませんでしたので、成績への影響はありません。
- QとAとで盤のサイズがちがうとき、IndexError例外が発生していました。



